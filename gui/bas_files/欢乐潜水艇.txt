0 :
10 GRAPH:CLEAR
20 PRINT "  ***  ³¬  ¼¶  ***","     »¶ÀÖÇ±Ë®Í§","      ÐÂµÄÓÎÏ·"
40 PRINT "      ÍË³öÓÎÏ·","  ----------------";
50 GOSUB 9500
60 IF TS-27 AND TS-1 GOTO 120 
70 CLS:PRINT "  »¶ÀÖÇ±Ë®Í§Éý¼¶°æ   ","    Produced by:","    Coolsoft (R)"
80 BOX 30,30,129,64:BOX 31,65,131,66:BOX 130,31,131,66
90 END
120 CLS:PRINT "***** ³õÊ¼ÉèÖÃ *****  Ç±Í§ÊýÁ¿:","  Ç±Í§ÓÍÁ¿:","  ³¡¾°Ñ¡Ôñ:","  µçÄÔÖÇÄÜ:";
140 TS=0:IC=2:IB=50:AI=5:WHILE T-13
150 LOCATE 2,12:PRINT IC:LOCATE 3,12:PRINT IB;
160 LOCATE 4,12:PRINT MID$("×©Ç½¶´Ñ¨ÑÒÊ¯¿Õ¼ä",MP*4+1,4)
170 LOCATE 5,12:PRINT MID$("ÈõÖÇÉµ¹ÏÒ»°ã´ÏÃ÷Ìì²Å",AI*4-3,4);
180 LOCATE TS+2,1:PRINT " ";
190 T=ASC(INKEY$)
200 IF T=20 OR T=21 THEN LOCATE TS+2,1:PRINT "  ";
210 TS=TS-(T=20)*(TS>0)+(T=21)*(TS<3)
220 IF TS=0 THEN IC=IC-(T=23)*(IC>2)+(T=22)*(IC<9)
230 IF TS=1 THEN IB=IB-((T=23)*(IB>10)-(T=22)*(IB<90))*10
240 IF TS=2 THEN MP=MP-(T=23)*(MP>0)+(T=22)*(MP<3)
250 IF TS=3 THEN AI=AI-(T=23)*(AI>1)+(T=22)*(AI<5)
260 IF T=27 GOTO 10
270 WEND:EC=IC
280 CLS:PRINT "***** Ç±Í§ÉèÖÃ *****
290 FOR T=1  TO IC
300 LOCATE 2,5:PRINT T"ºÅÇ±Í§Àà±ð","      Ñ¡ÔñÍæ¼Ò","      Ñ¡ÔñµçÄÔ
310 GOSUB 9500:IF TS=27 GOTO 10
320 SM(T)=TS:SB%(T)=IB:T2=T2+TS
330 NEXT
340 IF T2<2 OR T2=IC GOTO 370
350 LOCATE 2,5:PRINT "µçÄÔ¹¥»÷·½Ê½","      µçÄÔ»ìÕ½","      µçÄÔÁªÃË
360 GOSUB 9500:ON TS=27 GOTO 10:CG=TS
370 CLS:BOX 1,16,160,79,(MP=1),(MP=1):IF MP=3 THEN 430
380 FOR T=1  TO 65+(MP=1)*60:TX%=RND(1)*26:TY%=RND(1)*10:TX%=TX%*6+2:TY%=TY%*6+19
390 IF MP THEN ELLIPSE TX%,TY%,RND(1)*4+7-MP*3,RND(1)*4+7-MP*3,1,MP-1:420
400 BOX TX%,TY%,TX%+5,TY%+4,1:LINE TX%,TY%+2,TX%+5,TY%+2,0
410 DRAW TX%+2,TY%+2:LINE TX%+3,TY%+3,TX%+3,TY%+4,0
420 NEXT
430 DX%=RND(1)*120+20:DY%=RND(1)*30+25
440 FOR T=1  TO IC
450 SX%(T)=RND(1)*150+5:TX%=SX%(T):SY%(T)=RND(1)*50+20:TY%=SY%(T)
460 IF (DY%-TY%)^2+(DX%-TX%)^2<130 GOTO 450
470 FOR T1=T-1  TO 1 STEP -1:IF (TX%-SX%(T1))^2+(TY%-SY%(T1))^2<225 GOTO 450
480 NEXT:CIRCLE TX%,TY%,5,1,0
490 LOCATE 1,1:PRINT T;"ºÅÇ±Í§×é×°ÖÐ...
500 ST(T)=INT(RND(1)*2):TT=ST(T):TM=SM(T):GOSUB 9000
510 FOR T1=1  TO 4:CIRCLE TX%,TY%,5,0,2:FOR T2=1  TO 700:NEXT:NEXT:NEXT:YY=5
520 F=0:CM=0:ASS=0:CX%=0:CY%=0:SR=0:MX=0:NT=NT+1:IF NT>IC THEN NT=1
530 ON SB%(NT)<1 GOTO 520:SV=SV+1:IF SV>7 GOTO 8500
540 BOX DX%-3,DY%-14,DX%+3,DY%+14,1,0:IF ABS(48-DY%)>20 THEN YY=-YY
550 DY%=DY%+YY:BOX DX%-3,DY%-8,DX%+3,DY%+8:BOX DX%-1,DY%-9,DX%+1,DY%+9,1,2:LINE 1,16,160,16
560 TM=SM(NT):ON SM(NT)GOTO 2010:TT=ST(NT):SR=PEEK(1017):C=90:SC=180-ST(NT)*180
570 LOCATE 1,1:PRINT NT;"HP";SB%(NT)SPC(19-POS(1))
580 CIRCLE 59,7,7,1:BOX 71,1,113,8,1:BOX 115,1,157,8:LINE 53+TT*7,7,59+TT*7,7,0
590 WHILE ASS-1 OR PEEK(192)-255:sleep 30
600 TX%=SX%(NT):TY%=SY%(NT):PY%=TY%:X1=PEEK(195):Y=PEEK(191)
605 X2=PEEK(196)
610 IF X1<>255 OR X2<>255 THEN TY%=TY%+(X1=247)-(TY%>76)-(X2=247)+(TY%<18):710
620 IF Y=127 OR Y=247 THEN TX%=TX%+(Y=247)*(TX%<155)-(Y=127)*(TX%>5):ST(NT)=SGN(Y-127):700
630 ON PEEK(192)<>127 GOTO 650:F=F+2:T2=INT(F/5)*5:LOCATE 1,3:PRINT "ùØ";F
640 BOX 72+T2,10,75+T2,14:ASS=1:IF F>80 OR PEEK(191)=127 THEN 910 ELSE 900
650 IF PEEK(192)=247 AND C<175 THEN C=C+5:760
660 IF PEEK(191)=191 AND C>5 THEN C=C-5:760
670 IF PEEK(191)=239 THEN T=NT:SB%(T)=0:1215
680 ON PEEK(198)=239 GOTO 10:ON PEEK(191)=223 GOTO 890
690 GOTO 850
700 PX%=TX%+5*(TX%-SX%(NT)):GOSUB 9100:IF PS THEN 850 ELSE 720
710 IF PEEK(6592+INT(TX%/8)+TY%*20+(TY%-SY%(NT))*60)GOTO 850
720 CM=CM+1:IF CM>20 THEN TX%=SX%(NT):TY%=SY%(NT) ELSE BOX 72,2,72+CM*2,7,0,0
730 BOX SX%(NT)-3,SY%(NT)-2,SX%(NT)+3,SY%(NT)+1,1,0
740 SX%(NT)=TX%:SY%(NT)=TY%:TT=ST(NT):GOSUB 9000
760 CIRCLE 59,7,7,1
770 SC=-90-C+ST(NT)*2*C
780 X=COS(SC*.0175):Y=SIN(SC*.0175)
790 LINE 59,7,59+X*7,7+Y*7,0
800 DRAW CX%*(CX%>0),CY%,2
810 CX%=TX%+X*16:CY%=TY%+Y*16
830 DRAW CX%*(CX%>0),CY%,2
850 IF PEEK(1017)=SR THEN 900 ELSE SR=PEEK(1017):MX=MX+1:T=T=0:IF MX>40 GOTO 890
860 LINE TX%-2,TY%,TX%+2,TY%,T
880 BOX 116,2,116+MX,8:GOTO 900
890 LOCATE 1,1:PRINT NT;"ºÅÇ±Í§·ÅÆú¹¥»÷     ":FOR T=1  TO 2700:NEXT:MX=41:GOTO 910
900 WEND
910 GOSUB 9000:DRAW CX%*(CX%>0),CY%,2
920 IF MX>40 GOTO 520
930 IF SC>0 OR SC<-180 THEN G=13 ELSE G=-13
940 LOCATE 1,1:PRINT " üÍüÈ  üÍ    üÍ  üË 
950 BX%=SX%(NT):BY%=SY%(NT):LX%=BX%:LY%=BY%:SF%(NT)=SF%(NT)+1
970 BT=0:PX%=0:WHILE ABS(80-BX%)<76 AND ABS(48-BY%)<32
980 BT=BT+.13/F^.2
990 BX%=LX%+F*COS(SC*.0175)*BT
1000 BY%=LY%+F*SIN(SC*.0175)*BT-G*BT^2
1010 ON ABS(80-PX%)<76 GOSUB 8700
1020 PX%=BX%:PY%=BY%:K=PEEK(6592+PY%*20+INT(PX%/8))
1030 ON ABS(80-PX%)<76 GOSUB 8700
1040 IF K=0 GOTO 1090
1050 PX%=PX%-2+TT*4:GOSUB 9100:C=PS
1060 PX%=BX%:GOSUB 9100:IF PS+C AND (LX%-BX%)^2+(LY%-BY%)^2>15 GOTO 1100
1090 sleep 30:WEND:GOTO 520
1100 GOSUB 8700:IF ABS(BY%-DY%)>9 OR ABS(BX%-DX%)>5 THEN 1120
1110 TT=1-TT:LX%=BX%:LY%=BY%:SC=540-SC:G=-G:GOTO 970
1120 FOR T=1  TO 15:CIRCLE BX%,BY%,T*(T<10),(T<4)
1130 CIRCLE BX%,BY%,(T>6)*(T-6),1,0:NEXT
1140 FOR T=1  TO IC
1150 IF SB%(T)>0 THEN TX%=SX%(T):TY%=SY%(T):TT=ST(T):TM=SM(T):GOSUB 9000
1160 NEXT:GOTO 1240
1170 LOCATE 1,1:PRINT PC;"ºÅÇ±Í§ÖÐµ¯  HP:":TT=ST(PC):TM=SM(PC):GOSUB 9000
1180 CIRCLE TX%,TY%,5,0,2:T1=15+INT(F/13)
1190 FOR T2=SB%(PC) TO SB%(PC)-T1 STEP -.5
1200 LOCATE 1,17:PRINT INT(T2);SPC(20-POS(1)):NEXT
1210 SB%(PC)=SB%(PC)-T1
1211 CIRCLE TX%,TY%,5,0,2
1212 IF SB%(PC)>0 GOTO 1220 
1215 FOR T1=1  TO 24:CIRCLE TX%,TY%,T1*(T1<16),(T1<4)
1216 CIRCLE TX%,TY%,(T1>9)*(T1-9),1,0:NEXT
1219 TD=8:EC=EC-1:BX%=TX%:BY%=TY%:F=200:GOTO 1240
1220 FOR T2=1  TO 1200:NEXT
1230 GOTO 1260
1240 FOR PC=1  TO IC:TX%=SX%(PC):TY%=SY%(PC)
1250 IF (BX%-TX%)^2+(BY%-TY%)^2<(12+TD)^2 AND SB%(PC)>0 THEN SS%(NT)=SS%(NT)+1:1170
1260 NEXT:TD=0:LOCATE 1,1
1270 IF EC>1 GOTO 520
1280 IF EC THEN 1290 ELSE PRINT IC;"ËÒÇ±Í§È«±»»÷³Á!     ":1320
1290 FOR W=1  TO IC
1300 IF SB%(W)>0 THEN PRINT W;"ºÅÇ±Í§¿­Ðý¶ø¹é!     ":1320
1310 NEXT
1320 LINS$=INKEY$
1450 FOR T=1  TO IC
1460 IF SF%(T) THEN SB%(T)=SS%(T)/SF%(T)*100 ELSE SB%(T)=0
1470 NEXT
1570 K=ASC(INKEY$)
1580 NP=NP-(K=20)*(NP>0)+(K=21)*(IC-NP*4>4)
1600 IF K=27 GOTO 10 
1610 CLS:PRINT "No. ·¢Éä ÃüÖÐ ÃüÖÐÂÊ
1620 FOR T=NP*4+1  TO NP*4+4
1630 LOCATE T-NP*4+1,1
1640 IF T>IC GOTO 1680
1650 PRINT MID$("ÎÒµÐ",SM(T)*2+1,2);T;
1660 IF EC AND T=W OR SM(T) AND CG=2 THEN PRINT "";
1670 PRINT TAB(6);SF%(T);TAB(11);SS%(T);TAB(16);SB%(T);"%";
1680 NEXT:LINE 1,15,160,15
1700 GOTO 1570
2010 C=0:T1=200:ST=0:TX%=SX%(NT):TY%=SY%(NT)
2020 FOR T=1  TO IC
2030 T2=SQR((TX%-SX%(T))^2+(TY%-SY%(T))^2)
2040 IF SB%(T)>0 AND T1>T2 AND T-NT AND (CG=0 OR SM(T)=0) THEN T1=T2:C=T
2050 NEXT
2060 IF C=0 THEN LOCATE 1,1:PRINT "µçÄÔ×îÖÕ»ñÊ¤.      ":CG=2:1320
2070 LOCATE 1,1:PRINT NT;"ºÅµçÄÔ±¸Õ½ÖÐ...   
2080 FOR T=1  TO 6:BOX TX%-4,TY%-4,TX%+4,TY%+3,0,2:FOR T1=1  TO 700:NEXT:NEXT
2090 MX=SX%(C)-TX%:MY=SY%(C)-TY%
2100 IF MX THEN X=MX/ABS(MX) ELSE X=1
2110 IF MY THEN Y=MY/ABS(MY) ELSE Y=1
2112 IF ABS(MX)>7 AND ABS(MX)<30 THEN X=-X:2127
2115 FOR T=TX%  TO SX%(C) STEP X
2120 IF PEEK(6592+TY%*20+INT(T/8)) AND INT(T/8)-INT(TX%/8) THEN X=-X:2127
2125 NEXT
2127 IF ABS(MY)>6 AND ABS(MY)<25 THEN Y=-Y:2140
2128 FOR T=TY%+Y*4  TO SY%(C) STEP Y
2130 IF PEEK(6592+T*20+INT(TX%/8)) THEN Y=-Y:2140
2135 NEXT
2140 IF X>0 THEN ST(NT)=1 ELSE ST(NT)=0
2150 TT=ST(NT)
2160 WHILE ST<17
2170 PX%=TX%+X*6:PY%=TY%:GOSUB 9100
2180 IF PS OR ABS(TX%-80)>72 GOTO 2250
2210 SX%(NT)=SX%(NT)+X
2250 IF PEEK(6592+TY%*20+Y*80+INT(TX%/8)) OR ABS(TY%-48)>28 GOTO 2280
2260 SY%(NT)=SY%(NT)+Y
2280 BOX TX%-3,TY%-2,TX%+3,TY%+1,1,0:TX%=SX%(NT):TY%=SY%(NT):GOSUB 9000:ST=ST+1
2300 WEND
2310 MX=SX%(C)-TX%:MY=SY%(C)-TY%
2320 BOX TX%-3,TY%-2,TX%+3,TY%+1,1,0
2360 ST(NT)=(MX>0):TT=ST(NT):GOSUB 9000
3000 IF MX THEN TG=MY/MX ELSE TG=9
3020 SC=18*(TG>0)*(TG<=.33)+36*(TG>.33)*(TG<=.73)+54*(TG>.73)*(TG<=1.39)
3040 SC=SC+72*(TG>1.39)*(TG<=3.12)+84*(TG>3.12)+96*(TG<-3.03)+108*(TG>=-3.03)*(TG<-1.36)
3070 SC=SC+127*(TG>=-1.36)*(TG<-.72)+144*(TG>=-.72)*(TG<-.32)+162*(TG>=-.32)*(TG<0)
3120 SC=SC+(MY<=0)*180
3130 G=(-1)^(SC>180)*12
3140 IF ABS(MX)<2 OR ABS(MY)<2 THEN F=90:3180
3150 F=ABS(MX/COS(SC*.0175)*SQR(ABS(G/(MX*TAN(SC*.0175)-MY)))-INT(RND(1)*(45-AI*9)))
3170 IF F>180 THEN F=180
3180 FOR T=5  TO 9
3190 PX%=TX%+COS(SC*.0175)*T
3200 PY%=TY%+SIN(SC*.0175)*T
3210 GOSUB 9100
3220 IF PS AND ABS(48-PY%)<28 GOTO 890
3230 NEXT
3500 GOTO 940
4000 END
8500 goto 540:OPEN "SubTemp" FOR OUTPUT AS 1
8520 WRITE #1,IC,EC,AI,NT,GM,LM,CG,DX%,DY%,YY
8530 FOR T=1  TO IC
8540 WRITE #1,SM(T),ST(T),SB%(T),SX%(T),SY%(T),SF%(T),SS%(T)
8550 NEXT
8560 CLOSE 1
8570 CLEAR
8580 OPEN "SubTemp" FOR INPUT AS 1
8590 INPUT #1,IC,EC,AI,NT,GM,LM,CG,DX%,DY%,YY
8600 FOR T=1  TO IC
8610 INPUT #1,SM(T),ST(T),SB%(T),SX%(T),SY%(T),SF%(T),SS%(T)
8620 NEXT
8630 CLOSE 1
8640 GOTO 540
8700 BOX PX%-3+TT*2,PY%-1,PX%+1+TT*2,PY%+1,0,2
8710 LINE PX%+2-TT*4,PY%-1,PX%+2-TT*4,PY%+1,2
8720 DRAW PX%-1+TT*2,PY%,2
8730 RETURN
9000 LINE TX%,TY%-2,TX%+3-TT*6,TY%+1
9010 LINE TX%-1+TT*2,TY%-2,TX%-3+TT*6,TY%
9020 BOX TX%-2+TT,TY%-1,TX%+1+TT,TY%+1,1
9030 DRAW TX%+3-TT*6,TY%-1
9050 IF TM THEN LINE TX%,TY%-1,TX%,TY%,0
9060 RETURN
9100 K=PEEK (INT(PX%/8)+PY%*20+6592)
9110 TP%=PX%-8*INT(PX%/8)+1.55
9150 PS=INT(K/2^(8-TP%))-INT(K/2^(9-TP%))*2
9160 RETURN
9500 TS=0:BOX 32,31,127,63
9520 BOX 33,TS*16+32,126,TS*16+46,1,2
9530 K=ASC(INKEY$):IF K=27 THEN TS=27:9570
9540 BOX 33,TS*16+32,126,TS*16+46,1,2
9550 IF K=20 OR K=21 THEN TS=K-20
9560 IF K-13 THEN 9520
9570 RETURN