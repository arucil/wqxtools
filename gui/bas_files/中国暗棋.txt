10 GRAPH:dim a(10,10),b(10,10),c(10,10)
20 BOX 47,30,112,48:LINE 113,31,113,49:LINE 48,49,112,49
30 LOCATE 3,7:PRINT "ÖÐ¹ú°µÆå":FOR A=1  TO 2500:NEXT
40 CLS
50 FOR A=7  TO 135 STEP 16:LINE A,8,A,70:NEXT
60 FOR A=7  TO 71 STEP 16:LINE 7,A,135,A:NEXT:LINE 136,8,136,13:LINE 136,66,136,72
70 BOX 135,14,152,64:LINE 153,15,153,65:LINE 136,65,152,65:LINE 8,72,136,72
80 FOR B=15  TO 71 STEP 16:FOR A=15  TO 127 STEP 16
90 CIRCLE A,B,6,1:BOX A-6,B-3,A+6,B+3
100 NEXT:NEXT
105 LOCATE 2,18:PRINT "Çë":LOCATE 3,18:PRINT "ÉÔ":LOCATE 4,18:PRINT "ºò"
110 FOR A=0  TO 1
120 FOR B=1  TO 2:FOR C=2  TO 7:A(C,B+A*2)=(C-2)*1.1+1:NEXT:A(1,B+A*2)=1:NEXT
130 A(8,A*2+1)=1:A(8,A*2+2)=7:NEXT
140 FOR A=0  TO 1:FOR B=1  TO 2:FOR C=1  TO 8
150 B(C,B+A*2)=A:C(C,B+A*2)=1:NEXT:NEXT:NEXT
160 FOR A=1  TO 100:B=RND(1)*8+1:C=RND(1)*2+1:D=RND(1)*8+1:E=RND(1)*2+3
170 SWAP A(B,C),A(D,E):SWAP B(B,C),B(D,E):NEXT
180 LOCATE 2,18:PRINT "ºÚ":LOCATE 3,18:PRINT "·½":LOCATE 4,18:PRINT "×ß"
190 A=1:B=1:C=1:D=1:GOTO 500
200 ON A(A,B)-1 GOTO 280,330,350,390,420,430
220 IF B(A,B)=1 THEN 250
230 LINE M+2,N+1,M+8,N,0:LINE M+2,N+2,M+2,N+6,0:LINE M+3,N+4,M+8,N+4,0
235 LINE M+7,N+5,M+7,N+6,0
240 LINE M,N+7,M+10,N+7,0:LINE M+3,N+8,M+1,N+10,0:LINE M+7,N+8,M+9,N+10,0:RETURN
250 LINE M+4,N,M+5,N+1:LINE M+1,N+2,M+9,N+2:LINE M+3,N+3,M+4,N+5:DRAW M+2,N+5
260 LINE M+7,N+3,M+8,N+5:DRAW M+6,N+5:LINE M,N+7,M+10,N+7:LINE M+5,N+6,M+5,N+10
270 RETURN
280 LINE M,N+3,M,N+5,O:LINE M+2,N,M+2,N+7,O:LINE M+1,N+8,M+1,N+9,O
290 LINE M+3,N+8,M+3,N+9,O:LINE M+3,N+4,M+4,N+3,O:LINE M+5,N,M+5,N+2,O
300 LINE M+6,N+2,M+10,N+2,O:LINE M+10,N+3,M+10,N+7,O:DRAW M+9,N+7,O
310 BOX M+5,N+4,M+8,N+6,0,O:LINE M+5,N+7,M+5,N+9,O:LINE M+6,N+10,M+9,N+10,O
320 DRAW M+10,N+9,O:RETURN
330 LINE M+2,N+1,M+8,N+1,O:BOX M+2,N+3,M+8,N+7,0,O:LINE M+3,N+5,M+7,N+5,O
340 LINE M+5,N,M+5,N+10,O:LINE M+1,N+9,M+9,N+9,O:RETURN
350 BOX M+2,N,M+5,N+6,0,O:LINE M+6,N,M+8,N,O:LINE M+3,N+2,M+8,N+2,O
360 LINE M+3,N+4,M+8,N+4,O:LINE M+6,N+6,M+10,N+6,O:LINE M+10,N+7,M+10,N+9,O
370 LINE M+8,N+10,M+9,N+10,O:LINE M+1,N+9,M+2,N+8,O:LINE M+3,N+9,M+4,N+8,O
380 LINE M+5,N+9,M+6,N+8,O:LINE M+7,N+9,M+8,N+8,O:RETURN
390 LINE M,N+3,M+4,N+3,O:LINE M+2,N,M+2,N+10,O:LINE M+1,N+5,M+3,N+5,O
400 LINE M+1,N+6,M,N+8,O:DRAW M+4,N+6,O:BOX M+6,N+1,M+9,N+7,0,O
410 BOX M+6,N+4,M+9,N+10,0,O:RETURN
420 LINE M,N+5,M+10,N+5,O:LINE M+5,N,M+5,N+8,O:LINE M+2,N+9,M+8,N+9,O:RETURN
430 IF B(A,B)=1 THEN 460
440 LINE M+2,N,M+1,N+1,0:BOX M,N+2,M+2,N+5,0,0:DRAW M,N+6,0:BOX M,N+7,M+2,N+10,0,0
450 BOX M+4,N+3,M+10,N+8,0,0:LINE M+5,N+8,M+8,N+8:LINE M+7,N,M+7,N+10,0:RETURN
460 LINE M+3,N,M+3,N+10:LINE M+1,N+1,M+1,N+4:DRAW M+2,N+4:LINE M,N+6,M+2,N+6
470 LINE M+1,N+7,M+1,N+8:LINE M+7,N,M+5,N+2:LINE M+7,N+1,M+9,N+1
480 LINE M+7,N+2,M+6,N+3:LINE M+9,N+2,M+8,N+3:LINE M+5,N+4,M+7,N+4:LINE M+5,N+6,M+10,N+6
490 LINE M+8,N+5,M+8,N+10:DRAW M+7,N+10:LINE M+5,N+7,M+6,N+8:RETURN
500 BOX A*16-8,B*16-8,A*16+6,B*16+6,1,2
510 A$=INKEY$
520 BOX A*16-8,B*16-8,A*16+6,B*16+6,1,2
530 IF A$=CHR$(20) THEN B=B-1:IF B=0 THEN B=4
540 IF A$=CHR$(21) THEN B=B+1:IF B=5 THEN B=1
550 IF A$=CHR$(22) THEN A=A+1:IF A=9 THEN A=1
560 IF A$=CHR$(23) THEN A=A-1:IF A=0 THEN A=8
565 M=A*16-6:N=B*16-6
570 IF A$=CHR$(13) AND A(A,B)>0 THEN IF B(A,B)=P AND C(A,B)=2 OR C(A,B)=1 THEN 600
580 IF A$=CHR$(27) THEN 950
590 GOTO 500
600 IF C(A,B)=2 THEN 680
620 IF B(A,B)=0 THEN 660
630 BOX M+2,N,M+8,N+10,1,0:BOX M+1,N+1,M+9,N+9,0,0:BOX M,N+2,M+10,N+8,0,0
640 O=1:GOSUB 200
650 C(A,B)=2:F=F+1:P=1-P:GOTO 890
660 O=0:GOSUB 200
670 C(A,B)=2:F=F+1:P=1-P:GOTO 890
680 BOX M-2,N-2,M-1,N-1:BOX M-2,N+12,M-1,N+11:BOX M+12,N-2,M+11,N-1:BOX M+12,N+12,M+11,N+11
690 A$=INKEY$
700 IF A$<>CHR$(27) THEN 730
710 BOX M-2,N-2,M-1,N-1,0,0:BOX M-2,N+12,M-1,N+11,0,0
720 BOX M+12,N-2,M+11,N-1,0,0:BOX M+12,N+12,M+11,N+11,0,0:GOTO 500
730 IF A$=CHR$(20) THEN X=0:Y=-1:780
740 IF A$=CHR$(21) THEN X=0:Y=1:780
750 IF A$=CHR$(22) THEN X=1:Y=0:780
760 IF A$=CHR$(23) THEN X=-1:Y=0:780
770 GOTO 690
780 IF C(A+X,B+Y)<>2 OR (C(A+X,B+Y)=2 AND B(A+X,B+Y)=P) THEN 690
800 IF A(A+X,B+Y)>A(A,B) AND A(A+X,B+Y)-A(A,B)<>6 OR A(A,B)-A(A+X,B+Y)=6 THEN 690
810 BOX M-2,N-2,M+12,N+12,1,0
820 IF A(A+X,B+Y)<>A(A,B) THEN 840
825 BOX M+X*16-2,N+Y*16-2,M+X*16+12,N+Y*16+12,1,0
830 A(A,B)=0:B(A,B)=2:A=A+X:B=B+Y:A(A,B)=0:B(A,B)=2:S(0)=S(0)+1:S(1)=S(1)+1:P=1-P:GOTO 890
840 J=0:IF A(A+X,B+Y)=0 THEN J=1
845 A(A+X,B+Y)=A(A,B):A(A,B)=0:B(A,B)=2:A=A+X:B=B+Y:M=A*16-6:N=B*16-6:B(A,B)=P
850 CIRCLE M+5,N+5,6,1:BOX M-1,N+2,M+11,N+8
855 IF J=0 THEN S(P)=S(P)+1
860 IF P=1 THEN BOX M+2,N,M+8,N+10,1,0:BOX M+1,N+1,M+9,N+9,0,0:BOX M,N+2,M+10,N+8,0,0
870 O=P:GOSUB 200
880 P=1-P:GOTO 890
890 IF S(1)<16 OR S(0)<16 THEN 900
895 LOCATE 2,18:PRINT "ºÍ":LOCATE 3,18:PRINT "  ":LOCATE 4,18:PRINT "Æå":GOTO 930
900 IF F<32 THEN 910
901 LOCATE 2,18:IF S(1)=16 THEN PRINT "°×":V=1
902 IF S(0)=16 THEN PRINT "ºÚ":V=1
905 IF V=1 THEN LOCATE 4,18:PRINT "Ê¤":BEEP:GOTO 930
907 GOTO 960
910 IF P=0 THEN B$="ºÚ" ELSE B$="°×"
920 LOCATE 2,18:PRINT B$:SWAP A,C:SWAP B,D:GOTO 500
930 A$=INKEY$:IF A$<>CHR$(27) THEN 930
940 CLEAR:GOTO 80 
950 IF F=0 THEN POKE 199,155 ELSE 940
960 FOR I=1  TO 4:FOR H=1  TO 8
970 IF B(H,I)<>P THEN 1060
975 J=0
980 IF B(H-1,I)=1-P AND (A(H-1,I)<=A(H,I) AND A(H,I)-A(H-1,I)<6 OR A(H-1,I)-A(H,I)=6) THEN J=1
990 IF J=1 AND C(H-1,I)>0 OR B(H-1,I)=2 THEN 1090
995 J=0
1000 IF B(H+1,I)=1-P AND (A(H+1,I)<=A(H,I) AND A(H,I)-A(H+1,I)<6 OR A(H+1,I)-A(H,I)=6) THEN J=1
1010 IF J=1 AND C(H+1,I)>0 OR B(H+1,I)=2 THEN 1090
1015 J=0
1020 IF B(H,I-1)=1-P AND (A(H,I-1)<=A(H,I) AND A(H,I)-A(H,I-1)<6 OR A(H,I-1)-A(H,I)=6) THEN J=1
1030 IF J=1 AND C(H,I-1)>0 OR B(H,I-1)=2 THEN 1090
1035 J=0
1040 IF B(H,I+1)=1-P AND (A(H,I+1)<=A(H,I) AND A(H,I)-A(H,I+1)<6 OR A(H,I+1)-A(H,I)=6) THEN J=1
1050 IF J=1 AND C(H,I+1)>0 OR B(H,I+1)=2 THEN 1090
1060 NEXT:NEXT
1070 V=1:GOTO 905
1090 H=8:I=4:NEXT:NEXT:GOTO 910